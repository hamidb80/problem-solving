# Stolen from lab section in https://jsoftware.github.io/j-playground/ 
# and help of DeepSeek AI ( explained wierd J syntax )

Huffman â† {
  (1=â‰ ğ•©) ? ğ•¨ ;
  j â† 2â†‘â‹ğ•©
  i â† (Â¬âˆ˜âˆŠâŸœj) âŠ¸/ â†•â‰ ğ•©
  
  f â† (iâŠğ•©) âˆ¾ +Â´ jâŠğ•© # new frequencies
  s â† (iâŠğ•¨) âˆ¾ < jâŠğ•¨ # new symbols
  s ğ•Š f
}

Repr â† {
  (1=â‰ ğ•©) ? <ğ•¨ ;
  l â† (0âŠ‘ğ•¨) Repr (0âŠ‘ğ•©)
  r â† (1âŠ‘ğ•¨) Repr (1âŠ‘ğ•©)
  codes â† l âˆ¾ r
}

ToCodeImpl â† { 
   2= â€¢Type ğ•© ? ğ•¨ ;
   l â† (ğ•¨âˆ¾0) ToCodeImpl 0âŠ‘ğ•©
   r â† (ğ•¨âˆ¾1) ToCodeImpl 1âŠ‘ğ•©
   l â‹ˆ r
}

ToCode â† {
  t      â† âŸ¨âŸ© ToCodeImpl âŠ‘ğ•©
  codes  â† t Repr âŠ‘ğ•©
  string â† ({(âˆ¾ğ•ŠÂ¨)âŸ(1<â‰¡)â¥Šğ•©} ğ•©) # stolen from BQNcrate
  â‰ string â‰ codes
}

# Define symbols and frequencies
sym â†  âŸ¨'a','b','c', 'd', 'e', 'f'âŸ©
freq â† âŸ¨5,   9,  12, 13,   16, 45âŸ©

huffmanTree  â† sym Huffman freq
huffmanTable â† ToCode huffmanTree

â€¢Show huffmanTree
â€¢Show huffmanTable
-----------------------

# â”Œâ”€                               
# Â· â”Œâ”€                             
#   Â· 'f' âŸ¨ "cd" âŸ¨ "ab" 'e' âŸ© âŸ©    
#                               â”˜  
#                                 â”˜
# â”Œâ”€                 
# â•µ 'f' âŸ¨ 0 âŸ©        
#   'c' âŸ¨ 1 0 0 âŸ©    
#   'd' âŸ¨ 1 0 1 âŸ©    
#   'a' âŸ¨ 1 1 0 0 âŸ©  
#   'b' âŸ¨ 1 1 0 1 âŸ©  
#   'e' âŸ¨ 1 1 1 âŸ©    
#                   â”˜
# -----------------------